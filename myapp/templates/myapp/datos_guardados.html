<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Datos Guardados</title>
    {% load static %}  <!-- Cargar la etiqueta static -->
    <link rel="stylesheet" href="{% static 'myapp/styles.css' %}">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&family=Lato:wght@700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="container">
        <header>
            <h1 class="titulo">Datos Guardados</h1>
        </header>
        <main>
            <div class="copy-box">
                <div class="title">Datos del Cliente</div>
                <textarea id="dataTextArea" class="datos-textarea" readonly>
{% if datos.cfs %}CFS: {{ datos.cfs }}{% endif %}
{% if datos.rfs_ip_port %}RFS-IP-PORT: {{ datos.rfs_ip_port }}{% endif %}
{% if datos.cliente %}Cliente: {{ datos.cliente }}{% endif %}
{% if datos.sede %}SEDE: {{ datos.sede }}{% endif %}
{% if datos.dko %}DKO: {{ datos.dko }}{% endif %}
{% if datos.sw %}SW: {{ datos.sw }}{% endif %}
{% if datos.interface_sw %}Interface SW: {{ datos.interface_sw }}{% endif %}
{% if datos.pe %}PE: {{ datos.pe }}{% endif %}
{% if datos.interface_pe %}Interface PE: {{ datos.interface_pe }}{% endif %}
{% if datos.vrf %}VRF: {{ datos.vrf }}{% endif %}
{% if datos.rd %}RD: {{ datos.rd }}{% endif %}
{% if datos.unit %}Unit: {{ datos.unit }}{% endif %}
{% if datos.sv %}SV: {{ datos.sv }}{% endif %}
{% if datos.cv %}CV: {{ datos.cv }}{% endif %}
{% if datos.bw %}BW: {{ datos.bw }}{% endif %}
{% if datos.wan and datos.wan != '0.0.0.0/0' %}WAN: {{ datos.wan }}{% endif %}
{% if datos.asn %}ASN: {{ datos.asn }}{% endif %}
{% if datos.created_at %}Fecha de creación: {{ datos.created_at }}{% endif %}
                </textarea>
                <div class="button-container">
                    <button class="datos-button" onclick="copyToClipboard('dataTextArea')" aria-label="Copiar Datos">Copiar Datos</button>
                </div>
            </div>
            <div class="copy-box">
                <div class="title">Comandos Previos</div>
                <textarea id="commandsTextArea" class="datos-textarea" readonly>
bash
roci {{ datos.pe }}
configure private


show interfaces {{ datos.interface_pe }} | no | display set
show interfaces {{ datos.interface_pe }}.{{ datos.unit }} | display set | no
show routing-instances {{ datos.vrf }} | display set | match lo0
show routing-instances {{ datos.vrf }} | display set | match vrf
show | display set | match 16528:4800321
show | display set | match {{ datos.interface_pe }}.{{ datos.unit }} | no
run show route table {{ datos.vrf }} {{ datos.wan }}

show interfaces {{ datos.interface_pe }} | no | display set
                </textarea>
                <div class="button-container">
                    <button class="datos-button" onclick="copyToClipboard('commandsTextArea')" aria-label="Copiar Comandos">Copiar Comandos</button>
                </div>
            </div>
            <div class="copy-box">
                <div class="title">Configuración de la Interfaz</div>
                <textarea id="newCommandsTextArea" class="datos-textarea" readonly>
set interfaces {{ datos.interface_pe }} unit {{ datos.unit }} description "CUSTOMER:{{ datos.cliente }}(CFS:{{ datos.cfs }})(RFS:{{ datos.rfs_ip_port }})"
                </textarea>
                <div class="button-container">
                    <button class="datos-button" onclick="copyToClipboard('newCommandsTextArea')" aria-label="Copiar Nuevos Comandos">Copiar Nuevos Comandos</button>
                </div>
            </div>
            <div class="copy-box">
                <div class="title">Policers</div>
                <textarea id="policersTextArea" class="datos-textarea" readonly>
set class-of-service traffic-control-profiles {{ datos.interface_pe }}.{{ datos.unit }}-{{ BWx1024 }}-o scheduler-map GX-CUST-SCHEDULER-MAP-6Q
set class-of-service traffic-control-profiles {{ datos.interface_pe }}.{{ datos.unit }}-{{ BWx1024 }}-o shaping-rate {{ shaping_rate }}
set class-of-service traffic-control-profiles {{ datos.interface_pe }}.{{ datos.unit }}-{{ BWx1024 }}-o delay-buffer-rate {{delay_buffer_rate}}
set class-of-service interfaces {{ datos.interface_pe }} unit {{ datos.unit }} output-traffic-control-profile {{ datos.interface_pe }}.{{ datos.unit }}-{{ BWx1024 }}-o
set class-of-service interfaces {{ datos.interface_pe }} unit {{ datos.unit }} rewrite-rules ieee-802.1 XMR-I
set class-of-service interfaces {{ datos.interface_pe }} unit {{ datos.unit }} rewrite-rules ieee-802.1 CUST-PSR->EX
set firewall policer {{ datos.interface_pe }}.{{ datos.unit }}-in if-exceeding bandwidth-limit {{ shaping_rate }}
set firewall policer {{ datos.interface_pe }}.{{ datos.unit }}-in if-exceeding burst-size-limit {{burst_size_limit}}
set firewall policer {{ datos.interface_pe }}.{{ datos.unit }}-in then discard
set firewall policer {{ datos.interface_pe }}.{{ datos.unit }}-in if-exceeding bandwidth-limit {{ shaping_rate }}
set firewall policer {{ datos.interface_pe }}.{{ datos.unit }}-in if-exceeding burst-size-limit {{burst_size_limit}}
set firewall policer {{ datos.interface_pe }}.{{ datos.unit }}-in then discard
set routing-instances atento_ecopetrol interface {{ datos.interface_pe }}.{{ datos.unit }}
                </textarea>
                <div class="button-container">
                    <button class="datos-button" onclick="copyToClipboard('policersTextArea')" aria-label="Copiar Policers">Copiar Policers</button>
                </div>
            </div>
            <div class="button-container">
                <button class="datos-button" onclick="window.location.href='{% url 'datos' %}'" aria-label="Regresar">Regresar</button>
            </div>
        </main>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            var dataTextArea = document.getElementById('dataTextArea');
            var lines = dataTextArea.value.split('\n');
            var filteredLines = lines.filter(function(line) {
                return line.trim() !== '' && line.trim() !== 'WAN: 0.0.0.0/0';
            });
            dataTextArea.value = filteredLines.join('\n');
        });

        function copyToClipboard(elementId) {
            var copyText = document.getElementById(elementId);
            copyText.select();
            copyText.setSelectionRange(0, 99999); // Para dispositivos móviles
            document.execCommand("copy");
            alert("Texto copiado: " + copyText.value);
        }
    </script>
</body>
</html>
